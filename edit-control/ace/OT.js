if(typeof define!="function")var define=require("amdefine")(module);define(["require","./helpers/helpers-core"],function(e){var t=e("./helpers/helpers-core");return{transformRange:function(e,n){t.assert(e.sAction=="insert"||e.sAction=="delete","Invalid delta action: "+e.sAction);var r=n.oStart.iRow==n.oEnd.iRow&&n.oStart.iCol==n.oEnd.iCol;return{oStart:this._transformPoint(e,n.oStart,!1),oEnd:this._transformPoint(e,n.oEnd,r?!1:!0)}},_transformPoint:function(e,t,n){var r=e.sAction=="insert",i=e.oRange.oStart,s=e.oRange.oEnd,o=r?i:e.oRange.oEnd;if(t.iRow<i.iRow||t.iRow==i.iRow&&t.iCol<i.iCol)return{iRow:t.iRow,iCol:t.iCol};var u=n?t.iCol>o.iCol:t.iCol>=o.iCol;if(t.iRow>o.iRow||t.iRow==o.iRow&&u){var a=(r?1:-1)*(s.iRow-i.iRow),f=(r?1:-1)*(s.iCol-i.iCol);return{iRow:t.iRow+a,iCol:t.iCol+(t.iRow==o.iRow?f:0)}}return{iRow:i.iRow,iCol:i.iCol}}}});